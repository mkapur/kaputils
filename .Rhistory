values_from = value
)
mtemp$quants %>%
melt(id = c('Yr', 'Label')) %>%
filter(is.na(.$Yr))
mtemp$quants
mtemp$derived_quants
mtemp$derived_quants %>%
melt(id = c('Yr', 'Label')) %>%
filter(is.na(.$Yr))
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label))
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr))
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = value
)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = suff,
"IDX" = NA,
"REP" = paste0(suff,str_sub(variable, 6, -1))
)
splitpath
splitpath1
splitpath2
splitpath1[1]
splitpath
suff
#
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-Yr, -MOD, REP, -IDX, everything(), -variable)
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-Yr, -MOD, REP, -IDX, everything())
refList
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything())%>%
merge(., refList, by.x = c('REP'), by.y = c('REP'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = suff, IDX = NA) %>%
select(-Yr.y, -Yr.x, -IDX.y, -IDX.x, -MOD.y, -MOD.x) %>%
select(Yr, MOD, IDX, REP, everything()
)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything())
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('REP'), by.y = c('REP'), all.y = FALSE)
head(refList)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr))
#
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-Yr, -MOD, REP, -IDX, everything())
head(refList)
View(refList)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-Yr, -MOD, REP, -IDX, everything())
View(refList)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
)
#
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-MOD, REP, -IDX, everything())
View(refList)
#
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(MOD, REP, IDX, everything())
View(refList)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('MOD','REP','IDX'), by.y = c('MOD','REP','IDX'), all.y = FALSE)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything())
head(refList)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE)
#
refList <-  mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(!(Yr %in% mtemp$startyr:mtemp$endyr)) %>%
select(-Yr) %>%
pivot_wider(
.,
names_from = Label,
# id_cols = idcol,
values_from = Value
) %>%
mutate(
'Yr' = NA,
'MOD' = splitpath1[1],
"IDX" = IDX,
"REP" = splitpath
) %>%
select(-MOD, -REP, IDX, everything())
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = suff, IDX = NA)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = suff, IDX = IDX.x)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = MOD.x, IDX = IDX) %>%
select(-Yr.y, -Yr.x, -IDX.y, -IDX.x, -MOD.y, -MOD.x)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = MOD.x, IDX = IDX) %>%
select(-Yr.y, -Yr.x,  -MOD.y, -MOD.x)
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = MOD.x,, REP = REP.x, IDX = IDX) %>%
select(-Yr.y, -Yr.x,  -MOD.y, -MOD.x) %>%
select(Yr, MOD, IDX, REP, everything())
mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = MOD.x,, REP = REP.x, IDX = IDX) %>%
select(-Yr.y, -Yr.x, -REP.y, -REP.x, -MOD.y, -MOD.x) %>%
select(Yr, MOD, IDX, REP, everything())
mtq <- mtemp$derived_quants %>%
select(Label, Value) %>%
mutate(Yr = gsub(".*_", "", Label)) %>%
filter(Yr %in% mtemp$startyr:mtemp$endyr) %>%
# filter(!is.na(.$Year)) %>%
mutate(Label2 = gsub("_.*", "", Label)) %>%
pivot_wider(
.,
names_from = Label2,
id_cols = Yr,
values_from = Value
) %>%
mutate('MOD' = splitpath2[1],
"IDX" = IDX,
"REP" = splitpath) %>%
select(Yr, MOD, REP, IDX, everything()) %>%
merge(., refList, by.x = c('IDX'), by.y = c('IDX'), all.y = FALSE) %>%
mutate(Yr = Yr.x, MOD = MOD.x, REP = REP.x, IDX = IDX) %>%
select(-Yr.y, -Yr.x, -REP.y, -REP.x, -MOD.y, -MOD.x) %>%
select(Yr, MOD, IDX, REP, everything())
m == 1 & s == 1
s
!exists( paste0(
rootdir,
"/results/management_quantities_",
suff,
".csv"
))
paste0(
rootdir,
"/results/management_quantities_",
suff,
".csv"
)
devtools::load_all(".")
